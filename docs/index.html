<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>SKSimulator - 键鼠模拟器 SDK | SKSimulator键鼠模拟器 </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="SKSimulator - 键鼠模拟器 SDK | SKSimulator键鼠模拟器 ">
      
      
      <link rel="icon" href="favicon.ico">
      <link rel="stylesheet" href="public/docfx.min.css">
      <link rel="stylesheet" href="public/main.css">
      <meta name="docfx:navrel" content="toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="index.html">
            <img id="logo" class="svg" src="logo.svg" alt="SKSimulator键鼠模拟器">
            SKSimulator键鼠模拟器
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">

      <div class="content">
        <div class="actionbar">

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="sksimulator---键鼠模拟器-sdk">SKSimulator - 键鼠模拟器 SDK</h1>

<p>键鼠模拟器是一类专用硬件设备，能够通过底层信号模拟真实的键盘与鼠标输入操作。相比于传统的 PostMessage、SendInput、SetWindowsHookEx 等 Windows API 注入方式，软件模拟常常会被安全监控系统检测到（如获取窗口焦点、输入来源判别、消息钩子分析等），从而被微信、企业微信等主流应用识别为自动化行为，存在较高的风控和封号风险。而采用硬件级别的信号注入，输入几乎等同于真实用户操作，不会留下易被检测的 API 调用特征，具备极高的隐蔽性和安全性，非常适合需要高安全性的自动化场景。</p>
<h3 id="-工作原理对比">🔄 工作原理对比</h3>
<pre><code>┌─────────────────────────────────────────────────────────────────────────┐
│                        传统软件模拟方式                                  │
└─────────────────────────────────────────────────────────────────────────┘

    应用程序
        │
        ├─→ PostMessage/SendInput/SetWindowsHookEx
        │         │
        │         ├─→ Windows API 调用
        │         │         │
        │         │         ├─→ ⚠️ 可被检测特征
        │         │         │   ├─ 窗口焦点获取
        │         │         │   ├─ 输入来源判别
        │         │         │   └─ 消息钩子分析
        │         │         │
        │         │         └─→ 安全监控系统
        │         │                 │
        │         │                 └─→ ❌ 识别为自动化行为
        │         │                       └─→ 风控/封号风险
        │         │
        └─────────┴─────────────────────────────────────────────────────┘


┌─────────────────────────────────────────────────────────────────────────┐
│                         硬件键鼠模拟器方式                               │
└─────────────────────────────────────────────────────────────────────────┘

    应用程序
        │
        ├─→ SKSimulator SDK
        │         │
        │         ├─→ skm.dll (硬件驱动)
        │         │         │
        │         │         └─→ 🔌 硬件设备 (USB HID)
        │         │                 │
        │         │                 ├─→ ✅ 底层信号注入
        │         │                 │   ├─ 硬件级别输入
        │         │                 │   ├─ 无 API 调用特征
        │         │                 │   └─ 等同于真实用户操作
        │         │                 │
        │         │                 └─→ 操作系统
        │         │                         │
        │         │                         └─→ ✅ 识别为真实输入
        │         │                               └─→ 高隐蔽性/安全性
        │         │
        └─────────┴─────────────────────────────────────────────────────┘


┌─────────────────────────────────────────────────────────────────────────┐
│                            对比总结                                      │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  传统软件模拟              │  硬件键鼠模拟器                              │
│  ─────────────            │  ─────────────                              │
│  ❌ 易被检测              │  ✅ 高隐蔽性                                │
│  ❌ API 调用特征          │  ✅ 无 API 特征                             │
│  ❌ 风控风险高            │  ✅ 安全性高                                │
│  ❌ 可能被封号            │  ✅ 等同于真实操作                          │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre>
<p>本 SDK 采用 C# 实现，完整支持键盘和鼠标的各类操作，同时兼容 x86 与 x64 架构，自动管理 DLL 加载和依赖，无需手动干预。</p>
<p>👉 本键鼠模拟器也支持 C++ 集成。</p>
<ul>
<li>x86 架构：包含并链接 <code>x86/HKM.h</code> 和 <code>x86/hkm.lib</code></li>
<li>x64 架构：包含并链接 <code>x64/HKM.h</code> 和 <code>x64/hkm.lib</code><br>
只需在对应平台下引入相关头文件和库文件，即可方便调用 DLL 接口。</li>
</ul>
<h2 id="-功能特性">✨ 功能特性</h2>
<ul>
<li>🎯 <strong>完整的键鼠模拟功能</strong> - 支持键盘按键、鼠标移动、点击等所有操作</li>
<li>🔧 <strong>自动 DLL 管理</strong> - 自动根据运行环境（x86/x64）复制对应的 DLL 文件</li>
<li>📝 <strong>字符串输出</strong> - 支持 Unicode 和 ANSI 编码，支持中文输入</li>
<li>🖱️ <strong>DPI 感知</strong> - 支持多显示器 DPI 感知，确保坐标精度</li>
<li>⚙️ <strong>灵活配置</strong> - 可配置设备参数、输出模式、鼠标移动模式等</li>
<li>🔒 <strong>设备验证</strong> - 内置校验机制，提升安全性，支持硬件分发与授权管理</li>
<li>⏱️ <strong>随机延时</strong> - 内置随机延时功能，模拟更真实的操作</li>
</ul>
<h2 id="-系统要求">📋 系统要求</h2>
<ul>
<li>Windows 操作系统</li>
<li>键鼠模拟器硬件设备。本 SDK 需要配合硬件使用，如需硬件设备，请<a href="device.html">联系我</a></li>
</ul>
<h2 id="-快速开始">🚀 快速开始</h2>
<h3 id="1-克隆项目">1. 克隆项目</h3>
<pre><code class="lang-bash">git clone https://github.com/scottfly189/SKSimulator.git
cd src
</code></pre>
<h3 id="2-配置设备参数">2. 配置设备参数</h3>
<p>在 <code>Config.cs</code> 中配置您的设备参数：</p>
<pre><code class="lang-csharp">public static int KMDeiviceVID { get; set; } = 0x2612;  // 设备 VID
public static int KMDeivicePID { get; set; } = 0x1701;  // 设备 PID
public static string KMVerifyUserData { get; set; } = &quot;您的校验数据&quot;;
</code></pre>
<h3 id="3-准备-dll-文件">3. 准备 DLL 文件</h3>
<p>确保 <code>x64/skm.dll</code> 和 <code>x86/skm.dll</code> 文件存在于项目中。项目会自动根据运行环境复制对应的 DLL。</p>
<p>如下所示将 DLL 文件包含在项目中：</p>
<pre><code>  &lt;!-- 复制DLL到输出目录 --&gt;
  &lt;ItemGroup&gt;
    &lt;None Include=&quot;x64\skm.dll&quot;&gt;
      &lt;CopyToOutputDirectory&gt;PreserveNewest&lt;/CopyToOutputDirectory&gt;
       &lt;TargetPath&gt;x64\skm.dll&lt;/TargetPath&gt;
    &lt;/None&gt;
    &lt;None Include=&quot;x86\skm.dll&quot;&gt;
      &lt;CopyToOutputDirectory&gt;PreserveNewest&lt;/CopyToOutputDirectory&gt;
      &lt;TargetPath&gt;x86\skm.dll&lt;/TargetPath&gt;
    &lt;/None&gt;
  &lt;/ItemGroup&gt;
</code></pre>
<h3 id="4-编译运行">4. 编译运行</h3>
<pre><code class="lang-bash">dotnet build
dotnet run
</code></pre>
<h2 id="-使用示例">📖 使用示例</h2>
<h3 id="基本使用">基本使用</h3>
<pre><code class="lang-csharp">using SKM;

// 初始化设备
KMSimulatorService.Init(Config.KMDeiviceVID, Config.KMDeivicePID, Config.KMVerifyUserData);
IntPtr HKMData = KMSimulatorService.DeviceData;

// 设置模式（输出字符串编码、鼠标移动模式）
SkmCore.HKMSetMode(HKMData, 4, 4);

// 键盘操作示例
SkmCore.HKMKeyPress(HKMData, &quot;WIN+E&quot;);  // 组合键
SkmCore.HKMKeyDown(HKMData, &quot;Ctrl&quot;);
SkmCore.HKMKeyPress(HKMData, &quot;A&quot;);
SkmCore.HKMKeyUp(HKMData, &quot;Ctrl&quot;);

// 输出字符串（支持中文）
SkmCore.HKMOutputString(HKMData, &quot;ABC中文，可以打成全部是中文吗？&quot;);
SkmCore.HKMOutputString(HKMData, &quot;\r\n换行测试，Hello World!&quot;);

// 鼠标操作示例
SkmCore.HKMMoveR(HKMData, 100, 50);     // 相对移动
SkmCore.HKMMoveTo(HKMData, 200, 100);   // 绝对移动
SkmCore.HKMLeftClick(HKMData);          // 左键单击
SkmCore.HKMRightClick(HKMData);         // 右键单击
SkmCore.HKMLeftDoubleClick(HKMData);    // 左键双击

// 随机延时
SkmCore.HKMDelayRnd(HKMData, 100, 150);

// 关闭设备
KMSimulatorService.CloseDevice();
</code></pre>
<h3 id="完整示例">完整示例</h3>
<p>参考 <code>Program.cs</code> 中的完整示例代码。</p>
<h2 id="-配置说明">🔧 配置说明</h2>
<h3 id="config-类配置项">Config 类配置项</h3>
<table>
<thead>
<tr>
<th>配置项</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>KMDeiviceVID</code></td>
<td>int</td>
<td>0x2612</td>
<td>键鼠模拟器设备 VID</td>
</tr>
<tr>
<td><code>KMDeivicePID</code></td>
<td>int</td>
<td>0x1701</td>
<td>键鼠模拟器设备 PID</td>
</tr>
<tr>
<td><code>KMVerifyUserData</code></td>
<td>string</td>
<td>-</td>
<td>键鼠模拟器校验数据</td>
</tr>
<tr>
<td><code>KMOffsetOfClick</code></td>
<td>int</td>
<td>5</td>
<td>点击偏移量（像素）</td>
</tr>
<tr>
<td><code>KMOutputStringType</code></td>
<td>int</td>
<td>4</td>
<td>输出字符串编码类型</td>
</tr>
<tr>
<td><code>KMMouseMoveMode</code></td>
<td>int</td>
<td>0</td>
<td>鼠标移动模式</td>
</tr>
<tr>
<td><code>ProcessDpiAwareness</code></td>
<td>int</td>
<td>1</td>
<td>进程 DPI 感知值</td>
</tr>
</tbody>
</table>
<h3 id="dpi-感知配置">DPI 感知配置</h3>
<ul>
<li><code>0</code>: 不设置 DPI 感知</li>
<li><code>1</code>: <code>PROCESS_SYSTEM_DPI_AWARE</code> - 根据主显示器 DPI（默认）</li>
<li><code>2</code>: <code>PROCESS_PER_MONITOR_DPI_AWARE</code> - 根据每个显示器 DPI</li>
</ul>
<p><strong>注意</strong>:
键鼠模拟器受 DPI 感知影响，请正确设置 DPI。本 SDK 中也提供了 <code>DpiAwareness</code> 类供设置 DPI。</p>
<h2 id="-api-文档">📚 API 文档</h2>
<h3 id="kmsimulatorservice-类">KMSimulatorService 类</h3>
<p>设备管理服务类，提供设备初始化、搜索、打开、关闭等功能。</p>
<h4 id="主要方法">主要方法</h4>
<ul>
<li><code>Init(int deviceVID, int devicePID, string verifyUserData)</code> - 初始化设备</li>
<li><code>SearchDevice(int deviceVID, int devicePID)</code> - 搜索设备</li>
<li><code>OpenDevice(UInt32 deviceID)</code> - 打开设备</li>
<li><code>CloseDevice()</code> - 关闭设备</li>
<li><code>IsDeviceOpen()</code> - 判断设备是否打开</li>
</ul>
<h3 id="skmcore-类">SkmCore 类</h3>
<p><code>skm.dll</code> 的封装类，提供所有底层 API。</p>
<h4 id="键盘操作">键盘操作</h4>
<ul>
<li><code>HKMKeyPress(IntPtr HKMData, string KeyName)</code> - 按键</li>
<li><code>HKMKeyDown(IntPtr HKMData, string KeyName)</code> - 按下</li>
<li><code>HKMKeyUp(IntPtr HKMData, string KeyName)</code> - 弹起</li>
<li><code>HKMOutputString(IntPtr HKMData, string Str)</code> - 输出字符串</li>
<li><code>HKMReleaseKeyboard(IntPtr HKMData)</code> - 释放所有按键</li>
</ul>
<h4 id="鼠标操作">鼠标操作</h4>
<ul>
<li><code>HKMMoveTo(IntPtr HKMData, int X, int Y)</code> - 绝对移动</li>
<li><code>HKMMoveR(IntPtr HKMData, int X, int Y)</code> - 相对移动</li>
<li><code>HKMLeftClick(IntPtr HKMData)</code> - 左键单击</li>
<li><code>HKMRightClick(IntPtr HKMData)</code> - 右键单击</li>
<li><code>HKMMiddleClick(IntPtr HKMData)</code> - 中键单击</li>
<li><code>HKMLeftDoubleClick(IntPtr HKMData)</code> - 左键双击</li>
<li><code>HKMMouseWheel(IntPtr HKMData, int Count)</code> - 滚轮滚动</li>
</ul>
<h4 id="设备管理">设备管理</h4>
<ul>
<li><code>HKMSearchDevice(UInt32 Vid, UInt32 Pid, UInt32 DeviceType)</code> - 搜索设备</li>
<li><code>HKMOpen(UInt32 DeviceId, UInt32 DpiMode)</code> - 打开设备</li>
<li><code>HKMClose(IntPtr HKMData)</code> - 关闭设备</li>
<li><code>HKMSetMode(IntPtr HKMData, UInt32 Index, UInt32 Mode)</code> - 设置模式</li>
</ul>
<h4 id="工具方法">工具方法</h4>
<ul>
<li><code>HKMDelayRnd(IntPtr HKMData, UInt32 MinTime, UInt32 MaxTime)</code> - 随机延时</li>
<li><code>HKMGetCursorPos(IntPtr HKMData, ref int X, ref int Y)</code> - 获取鼠标坐标</li>
</ul>
<p>更多 API 请参考 <code>SKMCore.cs</code> 文件。</p>
<h2 id="-注意事项">⚠️ 注意事项</h2>
<ol>
<li><p><strong>DLL 文件</strong>:</p>
<ul>
<li>x64 环境需要使用 <code>x64/skm.dll</code></li>
<li>x86 环境需要使用 <code>x86/skm.dll</code></li>
<li><code>KMSimulatorService</code> 会自动根据当前环境复制 DLL，无需手动处理</li>
</ul>
</li>
<li><p><strong>DPI 感知</strong>:</p>
<ul>
<li>DPI 感知设置必须在任何窗口创建之前调用</li>
<li>如果应用程序已经设置了 DPI 感知，库的设置将无效</li>
</ul>
</li>
<li><p><strong>设备连接</strong>:</p>
<ul>
<li>使用前请确保键鼠模拟器设备已正确连接</li>
<li>检查设备 VID 和 PID 是否正确配置</li>
</ul>
</li>
<li><p><strong>字符串编码</strong>:</p>
<ul>
<li>如果中文出现乱码，使用 <code>HKMSetMode</code> 改变输出字符串编码</li>
<li>默认使用剪贴板粘贴方式输出字符串，速度快且不受输入法影响</li>
</ul>
</li>
<li><p><strong>线程安全</strong>:</p>
<ul>
<li>请确保设备操作在同一线程中进行，避免并发访问</li>
</ul>
</li>
</ol>
<h2 id="-相关链接">🔗 相关链接</h2>
<ul>
<li><a href="%E5%A6%82%E6%9C%89">SKSimulator 官方文档</a></li>
<li><a href="https://github.com/scottfly189/WeChatAuto.SDK.git">使用SKSimulator的开发框架 - WeChatAuto.SDK</a></li>
</ul>
<hr>
<p><strong>注意</strong>: 本项目仅用于学习和合法用途，请勿用于任何非法活动。</p>

</article>

        <div class="contribution d-print-none">
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://github.com/scottfly189/SKSimulator.git">SKSimulator</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
