<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>HKMSetMode 设置模式 | SKSimulator键鼠模拟器 </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="HKMSetMode 设置模式 | SKSimulator键鼠模拟器 ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo.svg" alt="SKSimulator键鼠模拟器">
            SKSimulator键鼠模拟器
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="hkmsetmode-设置模式">HKMSetMode 设置模式</h1>

<h2 id="功能">功能</h2>
<p>设置键鼠模拟器的工作模式，只对当前打开的设备有效</p>
<h2 id="参数">参数</h2>
<ul>
<li>参数1: 设备对象：无类型指针。使用<a href="HKMOpen.html">HKMOpen</a>可以创建它。</li>
<li>参数2: 属性：无符号32位整型数</li>
<li>参数3: 模式：无符号32位整型数</li>
</ul>
<h3 id="属性说明">属性说明</h3>
<h4 id="属性值-2">属性值: 2</h4>
<p>说明：用于设置鼠标的移动方式。可与下方模式值组合，实现多种鼠标移动效果。</p>
<ul>
<li><strong>模式值: 0</strong>：相对坐标移动（默认模式）,变速模式，开始加速，结束减速。使用快速移动时无效。</li>
<li><strong>模式值: 1</strong>：快速移动，只追求鼠标移动速度，不模仿手动操纵鼠标的移动方式</li>
<li><strong>模式值: 2</strong>：绝对鼠标移动，通常物理鼠标只有相对移动，这个是绝对移动，绝对移动只能在主显示器内移动，使用后HKMMoveTo和HKMMoveR2以绝对移动方式进行，需要键鼠模拟器开启“绝对鼠标”模式或者“相对鼠标+绝对鼠标”模式。注意：HKMMoveTo没在这里设置绝对鼠标移动也能用相对鼠标实现绝对移动，HKMMoveR2在这里设置绝对鼠标移动后会用绝对鼠标实现相对移动。</li>
<li><strong>模式值: 4</strong>：基础移动模式，移动到指定坐标只能在鼠标没使用“提高指针精确度”且“选择指针移动速度”在中间（物理鼠标相对移动坐标和屏幕坐标的比例是1:1），win10的Dpi是100%时使用，移动过程中不会修正其它鼠标移动的影响，优点是速度快些。使用绝对鼠标移动时无效，对HKMMoveR无效。</li>
<li><strong>模式值: 8</strong>：减匀速模式，无加减速，距离短时会降低速度。使用快速移动时无效，对于HKMMoveTo和HKMMoveR2在绝对鼠标移动和基础移动模式都没使用时无效。</li>
<li><strong>模式值: 16</strong>：定速模式，无加减速，距离短时不降低速度。使用快速移动时无效，对于HKMMoveTo和HKMMoveR2在绝对鼠标移动和基础移动模式都没使用时无效。</li>
</ul>
<h4 id="属性值-3">属性值: 3</h4>
<p>说明：鼠标滚轮工作方式</p>
<p>相关函数：<a href="HKMMouseWheel.md">HKMMouseWheel</a></p>
<ul>
<li><strong>模式值: 0</strong>：模拟手动滚轮，模拟手动滚轮的方式，速度较慢（默认模式）</li>
<li><strong>模式值: 1</strong>：快速滚动，只追求鼠标滚轮滚动速度，不模仿手动操纵鼠标滚轮的方式。</li>
</ul>
<h4 id="属性值4">属性值：4</h4>
<p>说明：字符串输出方式</p>
<p>输出字符串编码，不同窗口接受的字符串编码不同，选择错了会收到乱码，有关函数：<a href="HKMOutputString.md">HKMOutputString</a></p>
<ul>
<li><strong>模式值：0</strong>：输出ANSI字符串（默认模式）</li>
<li><strong>模式值：1</strong>：输出UNICODE字符串</li>
<li><strong>模式值：2</strong>：输输出ANSI字符串，与模式0的差异是：在输出半角数字、字母和部分字符时，和手动输入一样，速度更快，但更易受键盘或输入法干扰。</li>
<li><strong>模式值：3</strong>：输出UNICODE字符串，与模式1的差异是：在输出半角数字、字母和部分字符时，和手动输入一样，速度更快，但更易受键盘或输入法干扰。</li>
<li><strong>模式值：4</strong>：使用剪贴板粘贴输出字符串。优点是输出字符多时速度更快且不受输入法影响，缺点是会改写剪贴板的内容和不支持虚拟机外操作虚拟机内。</li>
</ul>
<h4 id="属性值5">属性值：5：</h4>
<p>说明：键盘鼠标同步方式</p>
<p>同步是等待盒子的数据被电脑硬件接收，但不代表系统已经处理了该数据，有时系统繁忙，电脑硬件接收到数据与系统处理该数据之间有时间差，一般这个时间较短，多数情况不到1毫秒。0是全部同步（默认模式），有关函数：<a href="HKMKeyPress.md">HKMKeyPress</a>、<a href="HKMKeyDown.md">HKMKeyDown</a>、<a href="HKMKeyUp.md">HKMKeyUp</a>、<a href="HKMLeftClick.md">HKMLeftClick</a>、<a href="HKMRightClick.md">HKMRightClick</a>、<a href="HKMMiddleClick.md">HKMMiddleClick</a>、<a href="HKMXBtn1Click.md">HKMXBtn1Click</a>、<a href="HKMXBtn2Click.md">HKMXBtn2Click</a>、<a href="HKMLeftDoubleClick.md">HKMLeftDoubleClick</a>、<a href="HKMRightDoubleClick.md">HKMRightDoubleClick</a>、<a href="HKMMiddleDoubleClick.md">HKMMiddleDoubleClick</a>、<a href="HKMXBtn1DoubleClick.md">HKMXBtn1DoubleClick</a>、<a href="HKMXBtn2DoubleClick.md">HKMXBtn2DoubleClick</a>、<a href="HKMLeftDown.md">HKMLeftDown</a>、<a href="HKMRightDown.md">HKMRightDown</a>、<a href="HKMMiddleDown.md">HKMMiddleDown</a>、<a href="HKMXBtn1Down.md">HKMXBtn1Down</a>、<a href="HKMXBtn2Down.md">HKMXBtn2Down</a>、<a href="HKMLeftUp.md">HKMLeftUp</a>、<a href="HKMRightUp.md">HKMRightUp</a>、<a href="HKMMiddleUp.md">HKMMiddleUp</a>、<a href="HKMXBtn1Up.md">HKMXBtn1Up</a>、<a href="HKMXBtn2Up.md">HKMXBtn2Up</a>、<a href="HKMMoveRP.md">HKMMoveRP</a>、<a href="HKMMouseWheelP.md">HKMMouseWheelP</a>、<a href="HKMOutputString.md">HKMOutputString</a></p>
<ul>
<li><strong>模式值: 0</strong>: 全部同步（默认模式）</li>
<li><strong>模式值: 1</strong>：键盘异步，不等待键盘动作完成直接返回</li>
<li><strong>模式值：2</strong>：鼠标异步，不等待鼠标动作完成直接返回</li>
</ul>
<h4 id="属性值6">属性值：6</h4>
<p>说明：随机延时的概率分布方式</p>
<p>相关函数：<a href="HKMDelayRnd.html">HKMDelayRnd</a>、<a href="HKMKeyPress.md">HKMKeyPress</a>、<a href="HKMLeftClick.md">HKMLeftClick</a>、<a href="HKMRightClick.md">HKMRightClick</a>、<a href="HKMMiddleClick.md">HKMMiddleClick</a>、<a href="HKMXBtn1Click.md">HKMXBtn1Click</a>、<a href="HKMXBtn2Click.md">HKMXBtn2Click</a>、<a href="HKMLeftDoubleClick.md">HKMLeftDoubleClick</a>、<a href="HKMRightDoubleClick.md">HKMRightDoubleClick</a>、<a href="HKMMiddleDoubleClick.md">HKMMiddleDoubleClick</a>、<a href="HKMXBtn1DoubleClick.md">HKMXBtn1DoubleClick</a>、<a href="HKMXBtn2DoubleClick.md">HKMXBtn2DoubleClick</a>、<a href="HKMOutputString.md">HKMOutputString</a></p>
<ul>
<li><strong>模式值：0</strong>：延时随机均匀分布，延时值的概率相同(默认模式)</li>
<li><strong>模式值：1</strong>：延时随机偏小分布，延时值越小，概率越高，最大值的概率接近0</li>
</ul>
<h4 id="属性值7">属性值：7</h4>
<p>说明：延时方式</p>
<p>相关函数：<a href="HKMDelayRnd.html">HKMDelayRnd</a>、<a href="HKMKeyPress.md">HKMKeyPress</a>、<a href="HKMLeftClick.md">HKMLeftClick</a>、<a href="HKMRightClick.md">HKMRightClick</a>、<a href="HKMMiddleClick.md">HKMMiddleClick</a>、<a href="HKMXBtn1Click.md">HKMXBtn1Click</a>、<a href="HKMXBtn2Click.md">HKMXBtn2Click</a>、<a href="HKMLeftDoubleClick.md">HKMLeftDoubleClick</a>、<a href="HKMRightDoubleClick.md">HKMRightDoubleClick</a>、<a href="HKMMiddleDoubleClick.md">HKMMiddleDoubleClick</a>、<a href="HKMXBtn1DoubleClick.md">HKMXBtn1DoubleClick</a>、<a href="HKMXBtn2DoubleClick.md">HKMXBtn2DoubleClick</a>、<a href="HKMOutputString.md">HKMOutputString</a></p>
<ul>
<li><strong>模式值：0</strong>：不处理窗口消息(默认模式)</li>
<li><strong>模式值：1</strong>：处理窗口消息</li>
</ul>
<h4 id="属性值32">属性值：32</h4>
<p>说明：字符串类型</p>
<p>函数参数和返回值中的字符串类型，用于解决有的编程工具对Unicode字符串支持不好的问题。有关函数：<a href="HKMGetDevString.html">HKMGetDevString</a>、<a href="HKMKeyPress.md">HKMKeyPress</a>、<a href="HKMKeyDown.md">HKMKeyDown</a>、<a href="HKMKeyUp.md">HKMKeyUp</a>、<a href="HKMOutputString.md">HKMOutputString</a>、<a href="HKMVerifyUserData.md">HKMVerifyUserData</a>、<a href="HKMVerifyUserData2.html">HKMVerifyUserData2</a></p>
<ul>
<li><strong>模式值：0</strong>：函数的字符串参数使用Unicode编码(默认模式)</li>
<li><strong>模式值：1</strong>：函数的字符串参数使用Ansi编码</li>
</ul>
<h2 id="返回值">返回值</h2>
<p>布尔值。成功返回True，失败返回False</p>
<h2 id="c例子">C#例子</h2>
<pre><code class="lang-csharp">uint dwDevId;
IntPtr lpDev;
dwDevId = SkmCore.HKMSearchDevice(0x1234, 0xABCD, 0);
if (dwDevId == 0xFFFFFFFF)
{
    Console.WriteLine(&quot;未找到键鼠模拟器&quot;);
    return;
}
lpDev = SkmCore.HKMOpen(dwDevId, 0);
if (lpDev == IntPtr.Zero)
{
    Console.WriteLine(&quot;打开键鼠模拟器失败&quot;);
    return;
}
SkmCore.HKMSetMode(lpDev, 2, 1);
SkmCore.HKMClose(lpDev);
</code></pre>
<h2 id="c语言例子">C语言例子</h2>
<pre><code>DWORD dwDevId;
LPVOID lpDev;
dwDevId=HKMSearchDevice(0x1234,0xABCD,0);
if(dwDevId==0xFFFFFFFF)
{
    printf(&quot;未找到键鼠模拟器\n&quot;);
    return 0;
}
lpDev=HKMOpen(dwDevId,0);
if(lpDev==NULL)
{
    printf(&quot;打开键鼠模拟器失败\n&quot;);
    return 0;
}
HKMSetMode(lpDev,2,1);
HKMClose(lpDev);
</code></pre>

</article>

        <div class="contribution d-print-none">
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://github.com/scottfly189/SKSimulator.git">SKSimulator</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
